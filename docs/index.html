<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Metal.js</title><meta name="theme-color" content="#9552ef"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/styles/main.css"><link rel="stylesheet" href="/vendor/codemirror/lib/codemirror.css"><link rel="stylesheet" href="/vendor/codemirror/theme/material.css"><script src="/vendor/codemirror/lib/codemirror.js"></script><script src="/vendor/codemirror/mode/soy/soy.js"></script><script src="/vendor/codemirror/mode/javascript/javascript.js"></script><script src="http://use.typekit.net/qed5qir.js"></script><script>try{Typekit.load();}catch(e){}</script></head><body><header class="header"><div class="container"><div class="header-bg"></div><nav class="topbar"><a class="topbar-logo" href="/"><img class="topbar-logo-image" src="/images/logo_signature@2x.png" alt="Metal.js Logo" width="35" height="28"><h1 class="topbar-logo-text">Metal.js</h1></a><ul class="topbar-menu"><li class="topbar-menu-item"><a class="topbar-menu-link" href="/docs/">Documentation</a></li><li class="topbar-menu-item"><a class="rounded-icon topbar-icon-github" target="_blank" href="https://github.com/metal/metal.js"><img src="/images/github_icon.svg" alt="GitHub Icon" width="16"></a></li></ul></nav></div></header><main class="docs"><div class="container"><div class="row"><nav class="docs-nav col-md-3"><p class="docs-nav-group">Intro</p><ul class="docs-nav-list"><li class="docs-nav-item"><a href="/docs/" class="docs-nav-link">Creating your own component</a></li><li class="docs-nav-item"><a href="/docs/building.html" class="docs-nav-link">Transpiling and building your component</a></li><li class="docs-nav-item"><a href="/docs/testing.html" class="docs-nav-link">Testing your component</a></li><li class="docs-nav-item"><a href="/docs/importing.html" class="docs-nav-link">Importing a third party component</a></li></ul><p class="docs-nav-group">Guides</p><ul class="docs-nav-list"><li class="docs-nav-item"><a href="/docs/alias.html" class="docs-nav-link">Alias</a></li><li class="docs-nav-item"><a href="/docs/attributes.html" class="docs-nav-link">Attributes</a></li><li class="docs-nav-item"><a href="/docs/soy-components.html" class="docs-nav-link">Soy Components</a></li><li class="docs-nav-item"><a href="/docs/component-lifecycle.html" class="docs-nav-link">Component Lifecycle</a></li><li class="docs-nav-item"><a href="/docs/nested-components.html" class="docs-nav-link">Nested Components</a></li><li class="docs-nav-item"><a href="/docs/overwriting-template-elements.html" class="docs-nav-link">Overwriting Template Elements</a></li><li class="docs-nav-item"><a href="/docs/inline-events.html" class="docs-nav-link">Inline Events</a></li><li class="docs-nav-item"><a href="/docs/decorate.html" class="docs-nav-link">Decorate</a></li><li class="docs-nav-item"><a href="/docs/performance.html" class="docs-nav-link">Performance</a></li></ul></nav><article class="docs-content col-md-6 col-md-offset-1"><h1>Creating your own component</h1><p>There are many different ways to create a new component using Metal.js. You can use the built-in integration with soy templates, or build your own template abstraction on top of Metal.js and use it instead. You can build the ES6 code using babel, traceur or any other transpiler. You can test using karma, jasmine or any other test framework, and can use any directory structure for your project. To sum it up, you can customize everything to your own needs. The world is your oyster.</p><p>This guide will focus on a quick and easy way to get started with Metal.js, using soy templates and <strong>generator-metal</strong> for the project structure and workflow.</p><h2>Dependencies</h2><ul><li>For importing the source code you'll need <a href="http://bower.io/">Bower</a>.</li><li>For build tooling, you'll need <a href="https://nodejs.org/download/">Node.js</a> v0.10 or newer.</li><li>For Soy templates compilation, you'll need Java SDK v1.7 or newer.</li></ul><h2>Creating the project structure</h2><p>We've built a <a href="https://www.npmjs.com/package/generator-metal">Yeoman generator</a> for creating the initial project structure together with some useful dependencies. To use it:</p><ol><li>Install Yeoman and <strong>generator-metal</strong>:<br><code>[sudo] npm i -g yo generator-metal</code></li><li>Open the folder that you want to use on your terminal and type:<br><code>yo metal</code></li><li>Answer the generator prompts</li><li>Wait for the generator to finish fetching dependencies</li></ol><p>So, for example, let's say you've decided to name your component <strong>MyComponent</strong>. After those steps you'll get a directory tree similar to this:</p><textarea class="code" data-mode="javascript">├── README.md
├── demos
│   └── index.html
├── gulpfile.js
├── node_modules
├── package.json
├── src
│   ├── MyComponent.js
│   ├── MyComponent.soy
│   └── myComponent.scss
└── test
    └── MyComponent.js</textarea><p>Building your component is now just a matter of adding code to the correct files:</p><ul><li><code>src/MyComponent.js</code> - Main JavaScript logic</li><li><code>src/MyComponent.soy</code>- Soy templates</li><li><code>src/myComponent.scss</code> - CSS rules</li><li><code>test/MyComponent.js</code> - Test cases</li><li><code>demos/index.js</code> - Demo</li></ul><h2>Soy</h2><p>Now we can actually start to code our new component. We'll be taking advantage of the built-in <a href="http://developers.google.com/closure/templates">soy templates</a> integration, enabling you to easily separate business logic from rendering logic.</p><p>So, for example, let's say that <strong>MyComponent</strong> should have a body and a footer with content. The soy file (<code>src/MyComponent.soy</code>) would look like this:</p><textarea class="code" data-mode="x-soy">
&lbrace;namespace Templates.MyComponent&rbrace;

/**
* This renders the component's whole content.
*/
&lbrace;template .render&rbrace;
&lbrace;call .body data="all" /&rbrace;
&lbrace;call .footer data="all" /&rbrace;
&lbrace;/template&rbrace;

/**
* This renders the body part of the component.
* @param bodyContent
*/
&lbrace;template .body&rbrace;
&lt;p&gt;&lbrace;$bodyContent&rbrace;&lt;/p&gt;
&lbrace;/template&rbrace;

/**
* This renders the footer part of the component.
* @param footerContent
*/
&lbrace;template .footer&rbrace;
&lt;footer&gt;&lbrace;$footerContent&rbrace;&lt;/footer&gt;
&lbrace;/template&rbrace;</textarea><p>Looking at that you can see that it's just a basic soy file that defines some templates. For this soy file to work well with Metal.js its namespace just needs to be in the format: <code>Templates.&lbrace;name of component&rbrace;</code>.</p><p>Now let's understand how this integration with the template works. Firstly, for each param used on soy templates, an <a href="/docs/attributes.html">attribute</a> is automatically added to the component, becoming the part of the component's state.</p><p>Also note that we have divided the main template into subtemplates, one for the body content and one for the footer. This is not necessary, but can be really helpful, as Metal.js will handle these as special parts of the component, automatically rerendering them when one of the attributes listed as params of a template changes. In MyComponent's case this means that whenever the value of the <code>bodyContent</code> attribute is changed, the <code>body</code> template will be called, and that part of the component will be updated, even though there is no JavaScript code on MyComponent to handle this logic. The same goes for the <code>footerContent</code> attribute and the <code>footer</code> template.</p><p>Metal.js's logic for updating the component's contents automatically is very smart, so it won't cause a rerender unless it's necessary. So if a change causes a template to be called again, but the resulting HTML from the template is the same that was rendered for the last time, it will be ignored. This is done by compressing and caching the hash code of a template's results when it's called, and later using it to compare with new results to decide if a new content should be rendered or not.</p><p>It's also important to know that each of the parts of your component that are defined by templates will be automatically wrapped in another element when rendered. These wrapper elements are used by Metal.js to quickly find the parts of the component that need to be updated when attributes change. If you need your templates to render correctly on their own though (through Java for example), or if you want to customize this wrapper element, you can overwrite it in your template. For more details and instructions on how to do this, visit the section about <a href="/docs/overwriting-template-elements.html">overwriting template elements</a>.</p><h2>JS</h2><p>Since all that rendering logic is done automatically for you just from creating a soy file, you don't actually need a JS file at all if that's all the component needs to do. When compiled, the soy file will already generate the appropriate component class for you.</p><p>Many components do need more behavior though, so to add more JS to a soy component you should have a JS file like this:</p><textarea class="code" data-mode="javascript">
import MyComponentBase './MyComponent.soy';

class MyComponent extends MyComponentBase {
}

export default MyComponent;</textarea><p>It basically just defines a class named MyComponent that extends from the auto-generated component inside the compiled soy file and exports it.<p>There are many ways to add behavior to your component. You can add handlers for <a href="/docs/inline-events.html">inline listeners</a>, add <a href="/docs/attributes.html">attributes</a> or simply override <a href="/docs/component-lifecycle.html">lifecycle functions</a> to add any other logic you need.</p><h2>Next steps</h2><p>Now that you know how to create your own components, let's learn how to transpile the ES6 code and build its modules to a desired format.</p><p><strong><a href="/docs/building.html">↪ Transpiling and building your component</a></strong></p></article></div></div></main><footer class="footer"><div class="container"><p class="footer-paragraph"><span class="footer-credits"><a class="rounded-icon footer-icon-liferay" target="_blank" href="http://liferay.com/"><img src="/images/liferay_logo.svg" alt="Liferay Icon" width="19" height="19"></a>Brought to you by <a class="footer-link" target="_blank" href="http://liferay.com/">Liferay, Inc</a>.</span><span class="footer-license"><a class="footer-link" target="_blank" href="https://github.com/metal/metal.js/blob/master/LICENSE.md">BSD</a> License.</span></p></div></footer><script src="/scripts/highlight.js"></script></body></html>